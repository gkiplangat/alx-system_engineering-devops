#!/bin/bash

# Function to display process hierarchy
display_process_hierarchy() {
    local pid=$1
    local level=$2
    local i
    for i in $(pgrep -P "$pid"); do
        printf "%${level}s|-- " ""
        ps -o pid,user,ppid,cmd -p "$i" --no-headers
        display_process_hierarchy "$i" $((level + 4))
    done
}

# Display header
printf "%-8s %-15s %-10s %s\n" "PID" "USER" "PPID" "COMMAND"

# Get all running processes with full information
IFS=$'\n'
processes=($(ps -eo pid,user,ppid,cmd --sort=-pid --no-headers))
unset IFS

# Iterate through the processes and display them
for process in "${processes[@]}"; do
    printf "%-8s %-15s %-10s %s\n" $process
    pid=$(echo "$process" | awk '{print $1}')
    display_process_hierarchy "$pid" 4
done

